apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: llm-demo-route
  namespace: default
spec:
  parentRefs:
    - group: gateway.networking.k8s.io
      kind: Gateway
      name: inference-gateway
  rules:
    # Rule 1: fast/cheap model
    - matches:
        - path:
            type: PathPrefix
            value: /
          headers:
            - type: Exact
              name: X-Gateway-Model-Name
              value: my-org/chat-fast
      backendRefs:
        - group: inference.networking.k8s.io
          kind: InferencePool
          name: cheap-llm-pool

    # Rule 2: expensive/high-quality model
    - matches:
        - path:
            type: PathPrefix
            value: /
          headers:
            - type: Exact
              name: X-Gateway-Model-Name
              value: my-org/chat-quality
      backendRefs:
        - group: inference.networking.k8s.io
          kind: InferencePool
          name: expensive-llm-pool

    # Rule 3: default fallback â†’ cheap pool
    - matches:
        - path:
            type: PathPrefix
            value: /
      backendRefs:
        - group: inference.networking.k8s.io
          kind: InferencePool
          name: cheap-llm-pool

